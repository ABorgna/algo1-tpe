
\begin{problema}{stockBebidasL}{l: Local, b:Bebida}{Cantidad}
\end{problema}

\begin{problema}{stockSandwichesL}{l: Local, h:Hamburguesa}{Cantidad}
	\requiere{h \in sandwichesDelLocal(l)}
	\asegura{\res == stockSandwiches(l,h)}
\end{problema}

\begin{problema}[bebidas]{bebidasDelLocalL}{l: Local}{[Bebida]}
    \asegura{mismos(\res,bebidasDelLocal(l))}
\end{problema}

\begin{problema}{sandwichesDelLocalL}{l: Local}{[Hamburguesa]}
\end{problema}

\begin{problema}{empleadosL}{l: Local}{[Empleado]}
\end{problema}

\begin{problema}{desempleadosL}{l: Local}{[Empleado]}
	\asegura{\res == desempleados(l)}
\end{problema}

\begin{problema}[energia]{energiaEmpleadoL}{l: Local, e:Empleado}{Energia}
    \requiere{e \in empleados(l)}
    \asegura{\res == energiaEmpleado(l,e)}
\end{problema}

\begin{problema}{ventasL}{l: Local}{[Pedido]}
\end{problema}

\begin{problema}{unaVentaCadaUno}{l:Local}{\bool}
\end{problema}

\begin{problema}{venderL}{l: Local, p:Pedido}{}
	\modifica{l}
	
	\requiere[siguientePedido]{numero(p) == max(numsVentas(l)) + 1}
	\requiere[vendeSandwich]{(\forall x \selec combos(p)) x \in sandwichesDelLocal(l)}
	\requiere[vendeBebida]{(\forall x \selec bebidas(p)) x \in bebidasDelLocal(l)}
	\requiere[stockBebidas]{(\forall b \selec bebidasDelLocal(l)) stockBebidas(l,b) \geq cantidadDeBebida(b,p)}
	\requiere[stockBebidas]{(\forall s \selec sandwichesDelLocal(l)) stockSandwiches(l,s) \geq cantidadDeSandwich(s,p)}
	\requiere{atendio(p) \in empleados(l)}
	
	\medskip
	\asegura{bebidasDelLocal(l) == bebidasDelLocal(pre(l))}
	\asegura{sandwichesDelLocal(l) == sandwichesDelLocal(pre(l))}
	\medskip	
	
	\asegura{\neg sePuede(pre(l),p) \Rightarrow mismos([x | x \selec empleados(pre(l)), x \neq atendio(p)], empleados(l) )}
	\asegura{\neg sePuede(pre(l),p) \Rightarrow mismos(desempleados(pre(l))++atendio(p), desempleados(l))}
	\asegura{\neg sePuede(pre(l),p) \Rightarrow (\forall e \selec empleados(l)) energiaEmpleados(l,e) == energiaEmpleados(pre(l))}
	\asegura{\neg sePuede(pre(l),p) \Rightarrow (\forall b \selec bebidasDelLocal(l))stockBebidas(l,b) == stockBebidas(pre(l))}
	\asegura{\neg sePuede(pre(l),p) \Rightarrow (\forall s \selec sandwichesDelLocal(l))stockSandwiches(l,s) == stockSandwiches(pre(l))}
	\asegura{\neg sePuede(pre(l),p) \Rightarrow ventas(l) == ventas(pre(l))}

	
	\medskip
	
	\asegura{sePuede(pre(l),p) \Rightarrow empleados(l) == empleados(pre(l))}
	\asegura{sePuede(pre(l),p) \Rightarrow desempleados(l) == desempleados(pre(l))}
	\asegura{sePuede(pre(l),p) \Rightarrow (\forall e \selec empleados(l), e \neq atendio(p)) energiaEmpleados(l,e) == energiaEmpleados(pre(l))}
	\asegura{sePuede(pre(l),p) \Rightarrow energiaEmpleados(l,atendio(p)) == energiaEmpleados(pre(l),atendio(p)) - energiaPedido(p)}
	\asegura{sePuede(pre(l),p) \Rightarrow (\forall b \selec bebidasDelLocal(l))stockBebidas(l,b) == stockBebidas(pre(l)) - cantBebida(b,p)}
	\asegura{sePuede(pre(l),p) \Rightarrow (\forall s \selec sandwichesDelLocal(l))stockSandwiches(l,s) == stockSandwiches(pre(l)) - cantSandwich(s,p)}
	\asegura{sePuede(pre(l),p) \Rightarrow mismos(ventas(l),ventas(pre(l))++p)}
	
	
	\medskip
	
	\aux{energiaPedido}{p : Pedido}{\ent}{
		\sum [dificultad(x) | x \selec combos(p)]
	}
	\aux{sePuede}{l : Local, p : Pedido}{\bool}{
		energiaEmpleado(atendio(p)) > energiaPedido(p)
	}
	\aux{cantSandwich}{s : Hamburguesa, p : Pedido}{\ent}{
		contar(s,[sandwich(c)|c \selec combos(p)])
	}
	\aux{cantBebida}{b : Bebida, p : Pedido}{\ent}{
		contar(b,[bebida(c)|c \selec combos(p)])
	}
\end{problema} %auxilio, no entra en la pantalla todo y no se me ocurre como achicarlo mas D:

\begin{problema}{candidatosAEmpleadosDelMesL}{l: Local}{[Empleado]}
    \requiere{|empleados(l)| > 0}
    \asegura{|\res| > 0}
    \asegura{mismos(\res, [e \: | \: e \selec empleados(l), ventasEchas(l,e) == maxVentas(l), \\ combosVendidos(l,e) == maxCombos(l,maxVentas(l))])}

    \medskip

    \aux{maxVentas}{l : Local}{\ent}{
        max([ventasEchas(l,e) \: | \: e \selec empleados(l)])
    }
    \aux{maxCombos}{l : Local, ventas : \ent}{\ent}{ \\
        max([combosVendidos(l,e) \: | \: e \selec empleados(l), ventasEchas(l,e) == ventas])
    }
\end{problema}

\begin{problema}{sancionL}{l: Local, e:Empleado, n:Energia}{}
\end{problema}

\begin{problema}{elVagonetaL}{l: Local}{Empleado}
\end{problema}

\begin{problema}{anularPedidoL}{l: Local, n: \ent}{}
	\modifica{l}
	\requiere[pedidoValido]{(\exists p \selec ventas(l)) numero(p)==n}
	\requiere[sigueEmpleado]{empleado(l,n) \in empleados(l)}
	
    \medskip
    
    \asegura{empleados(l) == empleados(pre(l))}
    \asegura{desempleados(l) == desempleados(pre(l))}
    \asegura{bebidasDelLocal(l) == bebidasDelLocal(pre(l))}
    \asegura{sandwichesDelLocal(l) == sandwichesDelLocal(pre(l))}
    \asegura{(\forall e \selec empleados(l), e \neq empleado(l,n)) energiaEmpleados(l,e) == energiaEmpleados(pre(l))}
    \asegura{energiaEmpleados(l,empleado(l,n)) == energiaEmpleados(pre(l),empleado(l,n)) + energiaPedido(pedido(pre(l),n))}
    \asegura{(\forall b \selec bebidasDelLocal(l))stockBebidas(l,b) == stockBebidas(pre(l)) + cantBebida(b,pedido(pre(l),n))}
    \asegura{(\forall s \selec sandwichesDelLocal(l))stockSandwiches(l,s) == stockSandwiches(pre(l)) + cantSandwich(s,pedido(pre(l),n))}
    \asegura{mismos(ventas(l),[v | v \selec ventas(pre(l)), v \neq pedido(pre(l),n)]}
    
    \medskip
    
    \aux{pedido}{l : Local, n : \ent}{Pedido}{
    	cab([p \: | \: p \selec ventas(l), numero(p) == n])
    }
    \aux{empleado}{l : Local, n : \ent}{Empleado}{
    	atendio(pedido(l,n))
    }
    \aux{cantSandwich}{s : Hamburguesa, p : Pedido}{\ent}{
    	contar(s,[sandwich(c)|c \selec combos(p)])
    }
    \aux{cantBebida}{b : Bebida, p : Pedido}{\ent}{
    	contar(b,[bebida(c)|c \selec combos(p)])
    }
    \aux{energiaPedido}{p : Pedido}{\ent}{
    	\sum [dificultad(x) | x \selec combos(p)]
    }
\end{problema}

\begin{problema}{agregarComboAlPedidoL}{l: Local, c: Combo, n:\ent}{}
    \requiere[pedidoValido]{(\exists p \selec ventas(l)) numero(p)==n}
    \requiere[hayBebidas]{bebida(c) \in bebidasDelLocal(l) \land stockBebidas(l,bebida(c)) > 0}
    \requiere[haySandwiches]{sandwich(c) \in sandwichesDelLocal(l) \land stockSandwiches(l,sandwich(c)) > 0}
    \requiere[sigueEmpleado]{empleado(l,n) \in empleados(l)}
    \requiere[energiaSuficiente]{energiaEmpleado(l,empleado(l,n)) \ge dificultad(c)}

    \medskip

    \modifica{l}

    \medskip

    \asegura{mismos(bebidasDelLocal(l), bebidasDelLocal(pre(l)))}
    \asegura{mismos(sandwichesDelLocal(l), sandwichesDelLocal(pre(l)))}
    \asegura{mismos(empleados(l), empleados(pre(l))}
    \asegura{mismos(desempleados(l), desempleados(pre(l))}
    \asegura{
        (\forall b \in bebidasDelLocal(l)) \\
        stockBebidas(l,b) == stockBebidas(pre(l),b) - \beta(b == bebida(c))
    }
    \asegura{
        (\forall s \in sandwichesDelLocal(l)) \\
        stockSandwiches(l,s) == stockSandwiches(pre(l),s) - \beta(s == sandwich(c))
    }
    \asegura[conservacionDeLaEnergia]{
        (\forall e \in empleados(l)) \\
        energiaEmpleado(l,e) == energiaEmpleado(pre(l),e) - \beta(e == empleado(pre(l),n)) * dificultad(c)
    }
    \asegura[conservaVentas]{ \\
        |ventas(l)| == |ventas(pre(l))| \land \\
        (\forall i \selec [0 \ldots |ventas(l)|), i \neq posPedido(pre(l),n)) ventas(l)[i] == ventas(pre(l))[i]
    }
    \asegura[agregaCombo]{ \\
        numero(ventas(l)[\: posPedido(pre(l),n) \:]) == numero(pedido(pre(l),n)) \land \\
        atendio(ventas(l)[\: posPedido(pre(l),n) \:]) == atendio(pedido(pre(l),n)) \land \\
        combos(ventas(l)[\: posPedido(pre(l),n) \:]) == combos(pedido(pre(l),n)) ++ [c]
    }

    \medskip

    \aux{pedido}{l : Local, n : \ent}{Pedido}{
        cab([p \: | \: p \selec ventas(l), numero(p) == n])
    }
    \aux{posPedido}{l : Local, n : \ent}{\ent}{
        find(ventas(l),pedido(l,n))
    }
    \aux{empleado}{l : Local, n : \ent}{Empleado}{
        atendio(pedido(l,n))
    }
\end{problema}

